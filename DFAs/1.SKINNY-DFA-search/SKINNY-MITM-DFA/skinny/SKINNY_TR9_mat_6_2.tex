\documentclass{standalone}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{patterns}
\usetikzlibrary{crypto.symbols}
\tikzset{shadows=no} 
\definecolor{orange}{rgb}{1,0.6,0.2}
\definecolor{blue}{rgb}{0,0.4,0.8}
\definecolor{red}{rgb}{0.9,0,0.4}
\definecolor{gray}{rgb}{0.7,0.7,0.7}
\definecolor{darkgreen}{rgb}{0,0.4,0.4}

\begin{document}
\begin{tikzpicture}[scale=0.6]

\everymath{\scriptstyle}
\tikzset{edge/.style=->, arrow head=1pt};
\begin{scope}[yshift=20cm]
   \begin{scope}[xshift=-10cm]
\path (4,-0.5) node {\tiny round $R-8$};
\draw[->] (2,1.5) -- ++(1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-8}$};
  \draw[fill=white] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=20cm]
   \begin{scope}[xshift=-7cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Y_{R-8}$};
  \draw[fill=white] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=20cm]
   \begin{scope}[xshift=-4cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Z_{R-8}$};
  \draw[fill=white] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=20cm]
   \begin{scope}[xshift=-1cm]
\path (4,-0.5) node {\tiny round $R-7$};
\draw[->] (2,1.5) -- ++(1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-7}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=20cm]
   \begin{scope}[xshift=2cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Y_{R-7}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=20cm]
   \begin{scope}[xshift=5cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Z_{R-7}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=16cm]
   \begin{scope}[xshift=-10cm]
\path (4,-0.5) node {\tiny round $R-6$};
\draw[->] (2,1.5) -- ++(1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-6}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=16cm]
   \begin{scope}[xshift=-7cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Y_{R-6}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=16cm]
   \begin{scope}[xshift=-4cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Z_{R-6}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=16cm]
   \begin{scope}[xshift=-1cm]
\path (4,-0.5) node {\tiny round $R-5$};
\draw[->] (2,1.5) -- ++(1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-5}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=16cm]
   \begin{scope}[xshift=2cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Y_{R-5}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=16cm]
   \begin{scope}[xshift=5cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Z_{R-5}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=12cm]
   \begin{scope}[xshift=-10cm]
\path (4,-0.5) node {\tiny round $R-4$};
\draw[->] (2,1.5) -- ++(1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-4}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=12cm]
   \begin{scope}[xshift=-7cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Y_{R-4}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=12cm]
   \begin{scope}[xshift=-4cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Z_{R-4}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=12cm]
   \begin{scope}[xshift=-1cm]
\path (4,-0.5) node {\tiny round $R-3$};
\draw[->] (2,1.5) -- ++(1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-3}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=12cm]
   \begin{scope}[xshift=2cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Y_{R-3}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=12cm]
   \begin{scope}[xshift=5cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (2,1.5) -- ++(1,0);
\draw(1,0) node {$Z_{R-3}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=white] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=5cm]
   \begin{scope}[xshift=-10cm]
\path (4,-0.5) node {\tiny round $R-2$};
\draw[->] (3,1.5) -- ++(-1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-2}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=red] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=5cm]
   \begin{scope}[xshift=-7cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (3,1.5) -- ++(-1,0);
\draw(1,0) node {$Y_{R-2}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=red] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=8cm]
   \begin{scope}[xshift=-7cm]
\draw (3,1.5) node{\tiny {$TK1$}};
\draw (1,0) node{\tiny $\oplus$};
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,fill=blue] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,0.5) rectangle +(0.5,0.5);
\draw[line width =1pt] (0,1.5) rectangle +(2,1);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=5cm]
   \begin{scope}[xshift=-4cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (3,1.5) -- ++(-1,0);
\draw(1,0) node {$Z_{R-2}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=red] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=-2cm]
   \begin{scope}[xshift=-1cm]
\draw(1,0) node {\tiny \tt{ciphertext}};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=5cm]
   \begin{scope}[xshift=-1cm]
\path (4,-0.5) node {\tiny round $R-1$};
\draw[->] (3,1.5) -- ++(-1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R-1}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=red] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=red] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=5cm]
   \begin{scope}[xshift=2cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (3,1.5) -- ++(-1,0);
\draw(1,0) node {$Y_{R-1}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=red] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=red] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=8cm]
   \begin{scope}[xshift=2cm]
\draw (3,1.5) node{\tiny {$TK1$}};
\draw (1,0) node{\tiny $\oplus$};
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,fill=red] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,fill=blue] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,0.5) rectangle +(0.5,0.5);
\draw[line width =1pt] (0,1.5) rectangle +(2,1);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=5cm]
   \begin{scope}[xshift=5cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (3,1.5) -- ++(-1,0);
\draw(1,0) node {$Z_{R-1}$};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=red] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=red] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=-2cm]
   \begin{scope}[xshift=-1cm]
\draw(1,0) node {\tiny \tt{ciphertext}};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=-2cm]
   \begin{scope}[xshift=-10cm]
\path (4,-0.5) node {\tiny round $R0$};
\draw[->] (3,1.5) -- ++(-1,0);
\draw[fill=gray!10, rounded corners, font={\sffamily\slshape}] (2.25,0.8) rectangle++(0.5,1.4);
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SC} +(0,0);
\draw[thin] (2.5,1.5) -- node[below] {\tiny\tt AC} +(0,0);
\draw(1,0) node {$X_{R0}$};
  \draw[fill=blue] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=red] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=orange] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=orange] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=-2cm]
   \begin{scope}[xshift=-7cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt SR} +(0,0);
\draw[->] (3,1.5) -- ++(-1,0);
\draw(1,0) node {$Y_{R0}$};
  \draw[fill=blue] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=red] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=orange] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=orange] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=1cm]
   \begin{scope}[xshift=-7cm]
\draw (3,1.5) node{\tiny {$TK1$}};
\draw (1,0) node{\tiny $\oplus$};
  \draw[draw=gray!80,fill=blue] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,fill=red] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,fill=blue] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,fill=orange] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[draw=gray!80,pattern = north west lines, pattern color = darkgreen] (1.5,0.5) rectangle +(0.5,0.5);
\draw[line width =1pt] (0,1.5) rectangle +(2,1);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=-2cm]
   \begin{scope}[xshift=-4cm]
\draw[thin] (2.5,1.5) -- node[above] {\tiny\tt MC} +(0,0);
\draw[->] (3,1.5) -- ++(-1,0);
\draw(1,0) node {$Z_{R0}$};
  \draw[fill=blue] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=red] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=orange] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=orange] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=blue] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[yshift=-2cm]
   \begin{scope}[xshift=-1cm]
\draw(1,0) node {\tiny \tt{ciphertext}};
  \draw[fill=gray] (0.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,2.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,1.0) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (0.5,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.0,0.5) rectangle +(0.5,0.5);
  \draw[fill=gray] (1.5,0.5) rectangle +(0.5,0.5);
	\end{scope}
    \end{scope}
\begin{scope}[shift={(-3,-5.5)}]
\draw[fill=gray]  (-7.5,0) rectangle ++(0.5,0.5);
\draw (-5,0.25) node {\small\tt Active Cell};
\draw[fill=white] (-2,0) rectangle ++(0.5,0.5);
\draw (0.5,0.25) node {\small\tt Inactive Cell};
\draw[fill=blue]  (4,0) rectangle ++(0.5,0.5);
\draw[fill=red]  (5,0) rectangle ++(0.5,0.5);\draw (9,0.25 ) node {\small\tt Value need to be guessed};
\draw[fill=orange]  (14,0) rectangle ++(0.5,0.5);
\draw (18,0.25) node {\small\tt Guessed in each direction};
\draw[pattern=north west lines, pattern color=darkgreen]  (22.5,0) rectangle ++(0.5,0.5);
\draw (28,0.25) node {\small\tt Subkey cells need not be guessed};
\end{scope}
  \end{tikzpicture}
\end{document}